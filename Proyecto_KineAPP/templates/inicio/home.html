{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Plataforma Kinesiolog√≠a UCN ‚Äî Men√∫ principal estudiante</title>
  <style>
    :root{
      --ucn-blue-900:#003366;
      --ucn-blue-700:#005AA7;
      --ucn-blue-50:#E6F2FF;
      --white:#FFFFFF;
      --gray-50:#FAFAFA;
      --gray-100:#F5F5F5;
      --gray-200:#ECECEC;
      --gray-300:#E0E0E0;
      --gray-400:#BDBDBD;
      --gray-600:#4D4D4D;
      --shadow: 0 8px 24px rgba(0,0,0,.08);
      --radius: 16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:"Inter", "Roboto", "Open Sans", system-ui, -apple-system, Segoe UI, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color:var(--gray-600);
      background:linear-gradient(180deg, var(--ucn-blue-50), var(--white));
    }
    .header{position:sticky;top:0;z-index:100;background:var(--white);border-bottom:1px solid var(--gray-200);box-shadow:0 2px 10px rgba(0,0,0,.03)}
    .header__inner{max-width:1200px;margin:0 auto;height:72px;display:flex;align-items:center;gap:16px;padding:0 20px}
    .logo{display:flex;align-items:center;gap:12px;min-width:220px; text-decoration: none;}
    .logo__mark{width:40px;height:40px;border-radius:50%;background:var(--ucn-blue-900);display:grid;place-items:center;color:#fff}
    .logo__text{display:flex;flex-direction:column;line-height:1.1}
    .logo__title{font-weight:700;color:var(--ucn-blue-900)}
    .logo__subtitle{font-size:.82rem;color:#446}
    .search{flex:1;display:flex;justify-content:center}
    .search__box{width:min(720px,100%);position:relative}
    .search__input{width:100%;height:44px;padding:0 44px 0 44px;border-radius:999px;border:1px solid var(--gray-300);outline:none;background:#fff;box-shadow:var(--shadow);font-size:15px}
    .search__icon{position:absolute;left:14px;top:50%;transform:translateY(-50%);opacity:.7}
    .header__actions{display:flex;align-items:center;gap:14px}
    .icon-btn{position:relative;width:44px;height:44px;border-radius:999px;display:grid;place-items:center;border:1px solid var(--gray-300);background:#fff;cursor:pointer}
    .icon-btn:hover{background:var(--gray-100)}
    .badge{position:absolute;right:-4px;top:-4px;min-width:20px;height:20px;padding:0 6px;border-radius:999px;background:crimson;color:#fff;font-size:.75rem;display:grid;place-items:center;font-weight:700}
    .avatar{width:44px;height:44px;border-radius:999px;background:linear-gradient(145deg,var(--ucn-blue-700),var(--ucn-blue-900));color:#fff;display:grid;place-items:center;font-weight:700; font-size: 1.1rem;}
    .container{max-width:800px;margin:24px auto;padding:0 20px}
    .section-head{display:flex;align-items:flex-end;justify-content:space-between;gap:16px;margin:8px 0 20px}
    .section-head__title{font-size:1.25rem;font-weight:800;color:var(--ucn-blue-900)}
    .filters{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .chip{padding:8px 12px;border-radius:999px;border:1px solid var(--gray-300);background:#fff;cursor:pointer;font-size:.9rem}
    .chip--primary{border-color:var(--ucn-blue-700);color:var(--ucn-blue-700);background:#f2f8ff}
    .list{display:flex;flex-direction:column;gap:20px}
    .card{background:#fff;border:1px solid var(--gray-200);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:row;align-items:center;gap:20px;padding:16px}
    .card__media{flex-shrink:0;width:160px;height:100px;background:radial-gradient(120% 120% at 0% 0%,#ffffff 0%,#e8f1ff 50%,#d7e8ff 100%);border-radius:12px;position:relative}
    .card__badge{position:absolute;left:8px;top:8px;background:var(--ucn-blue-900);color:#fff;padding:4px 8px;border-radius:999px;font-size:.78rem;font-weight:700}
    .card__body{flex:1;display:flex;flex-direction:column;gap:8px}
    .card__title{font-weight:800;color:#123; margin: 0;}
    .card__desc{font-size:.92rem;color:#566; margin: 0;}
    .progress{height:10px;width:100%;background:var(--gray-200);border-radius:999px;overflow:hidden}
    .progress__bar{height:100%;background:linear-gradient(90deg,var(--ucn-blue-700),var(--ucn-blue-900))}
    .progress__label{font-size:.8rem;color:#345}
    .card__footer{display:flex;align-items:center;justify-content:space-between;margin-top:6px}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:12px;border:1px solid var(--ucn-blue-700);color:#fff;background:linear-gradient(180deg,var(--ucn-blue-700),var(--ucn-blue-900));cursor:pointer;text-decoration:none;font-weight:700;font-size:.9rem}
    .btn:hover{filter:brightness(1.05)}
    .btn--ghost{background:#fff;color:var(--ucn-blue-700);border-color:var(--ucn-blue-700)}
    .modal{position:fixed;inset:0;display:none;align-items:flex-start;justify-content:flex-end;background:rgba(0,0,0,.2); z-index: 200;}
    .modal[aria-hidden="false"]{display:flex}
    .modal__panel{width:min(480px,100%);background:#fff;height:100%;box-shadow:-8px 0 24px rgba(0,0,0,.15);border-left:1px solid var(--gray-200);display:flex;flex-direction:column}
    .modal__header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--gray-200)}
    .modal__title{font-weight:800;color:var(--ucn-blue-900)}
    .modal__content{padding:12px 20px;overflow:auto}
    .notice{border:1px solid var(--gray-200);border-radius:12px;padding:12px;margin:10px 0;background:var(--gray-50)}
    .notice__title{font-weight:700}
    .notice__meta{font-size:.8rem;color:#667}
  </style>
</head>
<body>
  <header class="header">
    <div class="header__inner">
      <a href="#" class="logo">
        <div class="logo__mark">K</div>
        <div class="logo__text">
          <span class="logo__title">Kinesiolog√≠a UCN</span>
          <span class="logo__subtitle">Plataforma de Simulaci√≥n</span>
        </div>
      </a>
      <div class="search">
        <div class="search__box">
          <input class="search__input" type="search" placeholder="Buscar m√≥dulos, temas o pacientes..." />
        </div>
      </div>
      <div class="header__actions">
        <button id="btnNotificaciones" class="icon-btn"><span id="badgeCount" class="badge">1</span></button>
        
        <div class="avatar" title="{{ user.get_full_name }}">
            {% if user.first_name and user.last_name %}
                {{ user.first_name|slice:":1" }}{{ user.last_name|slice:":1" }}
            {% else %}
                {{ user.username|slice:":2"|upper }}
            {% endif %}
</div>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="section-head">
      <div>
        <div class="section-head__title">Hola, {{ user.first_name|default:user.username }} üëã</div>
        <div style="font-size:.92rem;color:#556">Estos son tus m√≥dulos activos. Selecciona uno para continuar.</div>
      </div>
    </div>

    <section class="list">
      
      {% for modulo in modulos_activos %}
      <article class="card">
        <div class="card__media">
            <span class="card__badge">{{ modulo.total_casos_visibles }} casos</span>
        </div>
        
        <div class="card__body">
          <h3 class="card__title">{{ modulo.nombre }}</h3>
          
          <p class="card__desc">{{ modulo.descripcion|truncatewords:15 }}</p>
          
          <div>
            <div class="progress">
                <div class="progress__bar" style="width: {{ modulo.progreso_calculado }}%"></div>
            </div>
            <div class="progress__label">Progreso: {{ modulo.progreso_calculado }}%</div>
          </div>
          
          <div class="card__footer">
            <a href="#" class="btn">Continuar</a>
            <button class="btn btn--ghost">Detalles</button>
          </div>
        </div>
      </article>
      {% empty %}
      <div style="text-align: center; padding: 40px; color: #888;">
          <p>No tienes m√≥dulos inscritos actualmente.</p>
      </div>
      {% endfor %}
      </section>
  </main>

  <div id="modalNotificaciones" class="modal" aria-hidden="true">
    <aside class="modal__panel">
      <div class="modal__header">
        <div class="modal__title">Avisos del profesor</div>
        <button id="btnCerrarModal" class="chip">Cerrar</button>
      </div>
      <div class="modal__content">
        <article class="notice">
          <div class="notice__title">Bienvenido a Kinergia Royale</div>
          <div class="notice__meta">Sistema ¬∑ Hoy</div>
          <p>Tu perfil ha sido creado exitosamente. Revisa tus m√≥dulos asignados.</p>
        </article>
      </div>
    </aside>
  </div>

  <script>
    const btnNotif=document.getElementById('btnNotificaciones');
    const modal=document.getElementById('modalNotificaciones');
    const btnCerrar=document.getElementById('btnCerrarModal');
    const badge=document.getElementById('badgeCount');
    const openModal=()=>{modal.setAttribute('aria-hidden','false');if(badge){badge.textContent='0';badge.style.background='#999'}};
    const closeModal=()=>{modal.setAttribute('aria-hidden','true')};
    btnNotif.addEventListener('click',openModal);
    btnCerrar.addEventListener('click',closeModal);
    modal.addEventListener('click',e=>{if(e.target===modal)closeModal()});
    document.addEventListener('keydown',e=>{if(e.key==='Escape'&&modal.getAttribute('aria-hidden')==='false')closeModal()});
  </script>
</body>
</html>